<!DOCTYPE html>
<html>

<head lang="en">
  <!-- <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> -->

  <!-- <meta http-equiv="x-ua-compatible" content="ie=edge"> -->
  
  <title>Neural Gaffer: Relighting Any Object via Diffusion</title>

  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="./files/slick.css">
  <link rel="stylesheet" type="text/css" href="./files/slick-theme.css">
  <link rel="stylesheet" href="./files/bulma.min.css">
  <link rel="stylesheet" href="./files/bulma-slider.min.css">
  <link rel="stylesheet" href="./files/bulma-carousel.min.css">
  <link rel="stylesheet" href="./files/bootstrap.min.css">
  <link rel="stylesheet" href="./files/font-awesome.min.css">
  <link rel="stylesheet" href="./files/codemirror.min.css">
  <link rel="stylesheet" href="./files/app.css">
  <link rel="stylesheet" href="./files/index.css">
  <link rel="stylesheet" href="./files/select.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

  <link rel="icon" type="image/png" sizes="96x96" href="./files/images/icons8-rainbow-48.png">
  <link rel="icon" type="image/png" sizes="48x48" href="files/images/icons8-rainbow-96.png">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="./files/bootstrap.min.js"></script>
  <script src="./files/codemirror.min.js"></script>
  <script src="./files/clipboard.min.js"></script>
  <script src="./files/video_comparison.js"></script>
  <script src="./files/select.js"></script>
  <script src="./files/bulma-slider.min.js"></script>
  <script src="./files/bulma-carousel.min.js"></script>
  <!-- <script src="./files/app.js"></script> -->
  <script src="./files/index.js"></script>
  <script defer src="./files/fontawesome.all.min.js"></script>
  <!-- <script src="./files/slick.js"></script> -->

</head>

<body>
  
  <div class="container" id="header" style="text-align: center; margin: auto;">
    <div class="row" id="title-row" style="max-width: 100%; margin: 0 auto;" >
      <h1 class="col-md-10 col-md-offset-1  text-center" id="title">
      <h1><span class="rainbow-text">Neural Gaffer</span>: Relighting Any Object via Diffusion</h1>
      </h1>
    </div>
    <div class="row" style="margin-top: -10px;">
      <h2>
        NeurIPS 2024
        <br>
      </h2>
    </div>
  </div>

  <div class="container" id="main">
    <div class="row">
      <div class="col-sm-10 col-sm-offset-1 text-center">
        <ul class="list-inline" >
          <li> <a href="https://haian-jin.github.io/">Haian Jin<sup>1</sup></a> </li>
          <li> <a href="https://y-u-a-n-l-i.github.io/">Yuan Li<sup>2</sup></a> </li>
          <li> <a href="https://scholar.google.com/citations?user=NLxrmYQAAAAJ&hl=en">Fujun Luan<sup>3</sup></a> </li>
          <li> <a href="https://kam1107.github.io/">Yuanbo Xiangli<sup>1</sup></a> </li>
          <li> <a href="https://sai-bi.github.io/">Sai Bi<sup>3</sup></a> </li>
          <li> <a href="https://kai-46.github.io/website/">Kai Zhang<sup>3</sup></a> </li>
          <br />
          <li> <a href="https://cseweb.ucsd.edu/~zex014/">Zexiang Xu<sup>3</sup></a> </li>
          <li> <a href="https://jinsungit.github.io/">Jin Sun<sup>4</sup></a> </li>
          <li> <a href="https://www.cs.cornell.edu/~snavely/">Noah Snavely<sup>1</sup></a> </li>
        </ul>
        <ul class="list-inline">
          <li> <sup>1</sup>Cornell University </li>
          <li> <sup>2</sup>Zhejiang University</li>
          <li> <sup>3</sup>Adobe Research </li>
          <li> <sup>4</sup>University of Georgia</li>
          <!-- <br />
          <li> * This work was done while Haian Jin was a full-time student at Cornell University.</li> -->
        </ul>
      </div>
    </div>
    <div class="row">
      <div class="col-md-8 col-md-offset-2 text-center">
        <span class="link-block">
          <a href="https://arxiv.org/abs/2406.07520" class="external-link button is-normal is-rounded is-dark">
            <span class="icon">
              <svg class="svg-inline--fa fa-file-pdf fa-w-12" aria-hidden="true" focusable="false" data-prefix="fas"
                data-icon="file-pdf" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="496" height="512"
                data-fa-i2svg="">
                <path fill="currentColor"
                  d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z">
                </path>
              </svg>
              <i class="fas fa-file-pdf"></i> 
            </span>
            <span>Paper</span>
          </a>
        </span>
        <span class="link-block">
          <a href="https://github.com/Haian-Jin/Neural_Gaffer" class="external-link button is-normal is-rounded is-dark">
            <span class="icon">
              <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab"
                data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg="" width="496" height="512">
                <path fill="currentColor"
                  d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
                </path>
              </svg>
            </span>
            <span>Code</span>
          </a>
        </span>
      </div>
    </div>


    <div class="row">
      <div class="col-md-10 col-md-offset-1 text-center">
        <div align="center">
          <h3><b>Neural Gaffer</b> is an end-to-end 2D relighting diffusion model that accurately relights any object in a <b>single image</b> under various lighting conditions.</h3>
        </div>
      </div>
    </div>

    <br>
    <br>
    <div class="row">
      <div class="col-md-10 col-md-offset-1">


        <div class="row">
          <div align="center">
          <video width="96%" height="96%" src='files/videos/teaser1.mp4' poster="files/loading.gif" muted="" autoplay="" loop="" playsinline="" >
          </video> 
          <video width="96%" height="96%" src='files/videos/teaser2.mp4' poster="files/loading.gif" muted="" autoplay="" loop="" playsinline="" >
          </video> 
        </div>
        
        <h3>
        <b>Abstract</b>
        </h3>
        <hr>
        </div>
        <div class="text-justify" style="font-size: 1.2em;">
          Single-image relighting is a challenging task that involves reasoning about the complex interplay between geometry, materials, and lighting. Many prior methods either support only specific categories of images, such as portraits, or require special capture conditions, like using a flashlight. Alternatively, some methods explicitly decompose a scene into intrinsic components, such as normals and BRDFs, which can be inaccurate or under-expressive. In this work, we propose a novel end-to-end 2D relighting diffusion model, called Neural Gaffer, that takes a single image of any object and can synthesize an accurate, high-quality relit image under any novel environmental lighting condition, simply by conditioning an image generator on a target environment map, without an explicit scene decomposition. Our method builds on a pre-trained diffusion model, and fine-tunes it on a synthetic relighting dataset, revealing and harnessing the inherent understanding of lighting present in the diffusion model. We evaluate our model on both synthetic and in-the-wild Internet imagery and demonstrate its advantages in terms of generalization and accuracy. Moreover, by combining with other generative methods, our model enables many downstream 2D tasks, such as text-based relighting and object insertion. Our model can also operate as a strong relighting prior for 3D tasks, such as relighting a radiance field.
        </div>

      </div>
    </div>
    <br>
    <br>
    

    <div class="row">
      <div class="col-sm-10 col-sm-offset-1" id="relighting_results">
        <h3>
          <b>Single-image Relighting Comparisons with IC-Light</b>
        </h3>
        <hr>  
        <div class="text-justify" style="font-size: 1.2em;">
          We compare with <a href="https://github.com/lllyasviel/IC-Light" style="font-size: 1.0em;">IC-Light</a> on single-image relighting under unseen lighting conditions. 
          Our methods can generate more consistent and stable relighting results wiht lighting changing and rotating.
        </div>
        <center>
        <h4>
          Lighting
        </h4>
        <ul class="nav nav-pills nav-justified" id="relighting" style="width: 60%">
          <li role="presentation" class="active">
            <a href="javascript: void(0);" onclick="ChangeRelighting(0);">Lighting 1</a>
          </li>
          <li role="presentation">
            <a href="javascript: void(0);" onclick="ChangeRelighting(1);">Lighting 2</a>
          </li>
          <li role="presentation">
            <a href="javascript: void(0);" onclick="ChangeRelighting(2);">Lighting 3</a>
          </li>

        </ul>
        <br>
        </center>

        <div align="center">
        <video id="XXX_Relighting" 
          width="100%" height="100%" 
          src='files/relighting/ic_lgt1.mp4' 
          poster="files/loading.gif" 
          muted="" autoplay="" loop="" playsinline="" >
        </video> 
        </div>

      </div>
    </div>
   
    <br>
    <br>


    <div class="row">
      <div class="col-sm-10 col-sm-offset-1" id="relighting_results">
        <h3>
          <b>Relighting 3D Objects Comparisons</b>
        </h3>
        <hr>  
        <div class="text-justify" style="font-size: 1.2em; line-height: 1.2em;">
          Given an input radiance field of a 3D object, our method can directly relight its appearance field in just minutes, <b>without requiring any inverse rendering reconstruction process </b> like those conventional methods.
          We compare with conventional inverse rendering reconstruction methods <a href="https://haian-jin.github.io/TensoIR/" style="font-size: 1.0em;">TensoIR</a> and <a href="https://github.com/NVlabs/nvdiffrecmc" style="font-size: 1.0em;">NVDIFFREC-MC</a> on 3D relighting under unseen lighting conditions, achieving better visual quality as shown below. 
          (The following videos are raw results without channel alignment.)
        </div>
        <center>
        <h4>
          Scene
        </h4>
        <ul class="nav nav-pills nav-justified" id="3D_relighting" style="width: 60%">
          <li role="presentation" class="active">
            <a href="javascript: void(0);" onclick="Change_3D_Relighting(0);">helmet</a>
          </li>
          <li role="presentation">
            <a href="javascript: void(0);" onclick="Change_3D_Relighting(1);">chair</a>
          </li>
          <li role="presentation">
            <a href="javascript: void(0);" onclick="Change_3D_Relighting(2);">backpack</a>
          </li>
          <li role="presentation">
            <a href="javascript: void(0);" onclick="Change_3D_Relighting(3);">iron</a>
          </li>
        </ul>
        <br>
        </center>

        <div align="center">
        <video id="XXX_3D_Relighting" 
          width="100%" height="100%" 
          src='files/relighting_3d/helmet.mp4' 
          poster="files/loading.gif" 
          muted="" autoplay="" loop="" playsinline="" >
        </video> 
        </div>

      </div>
    </div>
   
    <div class="row">
      <div class="col-sm-10 col-sm-offset-1" id="relighting_results">
        <h3>
          <b>Related Works</b>
        </h3>
        <hr>  
        <div class="text-justify" style="font-size: 1.2em;">
        
          <li>
            <a href="https://dilightnet.github.io/" style="font-size: 1.0em;">DiLightNet: Fine-grained Lighting Control for Diffusion-based Image Generation</a>:
            A recent work that enables fine-grained lighting control for diffusion-based image generation, which can be used for single-image relighting.
          </li>
          <li>
            <a href="https://illuminerf.github.io/" style="font-size: 1.0em;">IllumiNeRF 3D Relighting without Inverse Rendering</a>:
            A concurrent work that enables 3D relighting without inverse rendering, similar to our 3D relighting application.
          </li>
        
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-10 col-sm-offset-1" id="relighting_results">
        <h3>
          <b>Citation</b>
        </h3>
        <hr>  

     
          <div class="text-justify" style="font-size: 1.2em; line-height: 1.2em;">
            If you find our work useful in your research, please consider citing:
          </div>
          
          <br>
            <pre>
@inproceedings{jin2024neural_gaffer,
  title     = {Neural Gaffer: Relighting Any Object via Diffusion},
  author    = {Haian Jin and Yuan Li and Fujun Luan and Yuanbo Xiangli and Sai Bi and Kai Zhang and Zexiang Xu and Jin Sun and Noah Snavely},
  booktitle = {Advances in Neural Information Processing Systems},
  year      = {2024},
}
            </pre>
          


      </div>
    </div>
    <div class="row">
      
      <div class="col-sm-10 col-sm-offset-1" id="relighting_results">
        <h3>
          <b>Acknowledgements</b>
        </h3>
        <hr>  
        <div class="text-justify" style="font-size: 1.2em;">
          <li>
            This work was done while Haian Jin was a full-time student at Cornell. The selection of data and the
generation of all figures and results was led by Cornell University. This work was funded in part by
the National Science Foundation (IIS-2211259). Jin Sun is partly supported by a gift from Google.
          </li>
          <li>
            The selection of data and the generation of all figures and results was led by Cornell University.
          </li>
          <li>
          The website template was borrowed from <a href="https://haian-jin.github.io/TensoIR/" style="font-size: 1.0em;">TensoIR</a> and <a href="https://climatenerf.github.io/" style="font-size: 1.0em;">ClimateNeRF</a>.
          </li>
        </div>
      </div>
    </div>
  </div>
</body>

</html>